"use strict";(self.webpackChunknritya_webApp=self.webpackChunknritya_webApp||[]).push([[1893],{41893:(e,t,a)=>{a.r(t),a.d(t,{default:()=>F});var n=a(72791),o=a(47022),c=a(95313),s=a(43360),r=a(59434),l=a(60717),i=a(68449),d=a(83708),h=a(67107),u=a(44507),m=a(35527),g=a(20890),p=a(63875),b=a(74512),x=a(15825),f=a(66934),y=a(56856),w=a(23285),j=a(80184);const v=(0,f.ZP)(y.Z)((e=>{let{theme:t}=e;return{["&.".concat(w.Z.alternativeLabel)]:{top:10,left:"calc(-50% + 16px)",right:"calc(50% + 16px)"},["&.".concat(w.Z.active)]:{["& .".concat(w.Z.line)]:{borderColor:"green"}},["&.".concat(w.Z.completed)]:{["& .".concat(w.Z.line)]:{borderColor:"green"}},["& .".concat(w.Z.line)]:{borderColor:"dark"===t.palette.mode?t.palette.grey[800]:"#eaeaf0",borderTopWidth:3,borderRadius:1}}})),C=[d.n$.SUBMITTED,d.n$.UNDER_REVIEW,d.n$.REVIEWED,d.n$.VERIFIED],E={[d.n$.SUBMITTED]:0,[d.n$.UNDER_REVIEW]:1,[d.n$.REVIEWED]:2,[d.n$.VERIFIED]:3,[d.n$.VERIFICATION_FAILED]:3},S=e=>{let{kycId:t,status:a}=e;const o=(0,r.v9)(l.w),[c,s]=(0,n.useState)({});console.log(a);const f=(0,h.Z)({palette:{mode:o?"dark":"light",primary:{main:o?"#90caf9":"#1976d2"}}});return(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,i.Ld)(d.Ul.USER_KYC,t);s(e)}catch(e){console.error("Error fetching KYC data for KYC ID ".concat(t,":"),e)}})()}),[t]),(0,j.jsx)(u.Z,{theme:f,children:(0,j.jsxs)(m.Z,{sx:{textAlign:"center",marginBottom:"1rem"},elevation:2,children:[(0,j.jsxs)(g.Z,{variant:"h5",component:"p",children:["Application Status: ",a]}),(0,j.jsx)("br",{}),(0,j.jsx)(p.Z,{activeStep:E[a],alternativeLabel:!0,connector:(0,j.jsx)(v,{}),children:C.map(((e,t)=>(0,j.jsx)(b.Z,{children:(0,j.jsx)(x.Z,{error:e===d.n$.VERIFIED&&a===d.n$.VERIFICATION_FAILED,children:e===d.n$.VERIFIED&&a===d.n$.VERIFICATION_FAILED?"Failed Verification":e})},t)))}),(0,j.jsx)("br",{})]})})};var k=a(89704),I=a.n(k);const _=(e,t)=>{let a="";switch(console.log(e,t),e){case"phone_number":/^\d{10}$/.test(t)||(a="Phone number must be exactly 10 digits.");break;case"zip_pin_code":/^\d{6}$/.test(t)||(a="ZIP/Pin code must be exactly 6 digits.");break;case"aadhar":t&&!/^\d{12}$/.test(t)&&(a="Aadhar number must be exactly 12 digits.");break;case"gstin":t&&!/^[0-9]{2}[A-Za-z]{5}[0-9]{4}[A-Za-z]{1}[1-9A-Za-z]{1}[Zz]{1}[0-9A-Za-z]{1}$/.test(t)&&(a="GSTIN must be a valid format (e.g., 22ABCDE0000A1Z5).")}return console.log(a),a};var U=a(18406),R=a(57482),Z=a(82873),N=a(65202);const A=new Map([["first_name","First Name"],["middle_last_name","Middle & Last Name"],["phone_number","Phone Number"],["street_address","Street Address"],["city","City"],["state_province","State"],["state","State"],["zip_pin_code","PIN Code/ZIP"],["aadhar","Aadhar Number"],["gstin","GST Number"],["comments","Remark(s)"]]),T=[["first_name"],["middle_last_name"],["phone_number"],["street_address"],["city"],["state_province","state"],["zip_pin_code"]],D=Z.c,O=N.$;const F=function(){var e,t,a;const[h,u]=(0,n.useState)({first_name:"",middle_last_name:"",phone_number:"",street_address:"",city:"",state_province:"",zip_pin_code:"",country:"India",aadhar:"",gstin:"",comments:"",status:d.n$.SUBMITTED,tncAgreed:!1,hash:""}),[m,p]=(0,n.useState)(null),b=(0,r.v9)(l.w),[x,f]=(0,n.useState)({}),y=null===(e=JSON.parse(localStorage.getItem("userInfo")))||void 0===e?void 0:e.UserId,w="".concat(y,"_Kyc"),[v,C]=(0,n.useState)(null),[E,k]=(0,n.useState)(null),[Z,N]=(0,n.useState)([]),[F,L]=(0,n.useState)([]),[V,$]=(0,n.useState)(!1),[G,K]=(0,n.useState)(-1),[M,Y]=(0,n.useState)(-1),[B,P]=(0,n.useState)(!1),J=null===(t=JSON.parse(localStorage.getItem("userInfo")))||void 0===t?void 0:t.email,q=null===(a=JSON.parse(localStorage.getItem("userInfo")))||void 0===a?void 0:a.displayName,z=e=>{const{name:t,value:a}=e.target,n=_(t,a);f((e=>({...e,[t]:n}))),u((e=>({...e,[t]:a})))};(0,n.useEffect)((()=>{(async()=>{const e=await(0,i.Ld)(d.Ul.USER_KYC,w);e?(p(e),u({...e,status:e.status||d.n$.SUBMITTED})):p(null)})(),(async()=>{const e="".concat(d.Rb.CREATORS_KYC_DOCUMENTS,"/").concat(y);try{const[t,a]=await Promise.all([(0,i.XG)("".concat(e,"/Aadhar/")),(0,i.XG)("".concat(e,"/Gst/"))]);t&&t.length>0?C(t):(C(null),console.warn("No Aadhar documents found.")),a&&a.length>0?k(a):(k(null),console.warn("No GST documents found."))}catch(t){console.error("Error fetching KYC documents:",t)}})()}),[w]);const H=["status","hash","country","tncAgreed","comments","UserId","gstin","aadhar"];return(0,j.jsxs)("div",{style:{color:b?"white":"black"},children:[(0,j.jsxs)(o.Z,{className:"glassmorphic-container",style:{margin:"auto",border:b?"1px solid white":"1px solid black",borderRadius:"5px",padding:"20px"},children:[(0,j.jsxs)(c.Z,{onSubmit:async e=>{e.preventDefault(),P(!0);try{const t=Object.keys(h).filter((e=>!["hash","status","country","comments","UserId"].includes(e)));let a=!0,n=[],o=0;if(t.forEach((e=>{const t=_(e,h[e]);t&&(a=!1,o+=1,n.push("".concat(o,": ").concat(t)),f((a=>({...a,[e]:t}))))})),!a)return void alert("Please correct the following errors before submitting:\n\n".concat(n.join("\n")));const c=await(0,i.Ld)(d.Ul.USER_KYC,w),s=(e=>{const t=Object.keys(e).filter((e=>"hash"!==e&&"status"!==e)).sort().map((t=>"".concat(t,":").concat(e[t]))).join("|");return I().SHA256(t).toString()})(h);console.log(s,null===c||void 0===c?void 0:c.hash);const r=J,l={user_name:q,user_id:y};if(c){if(c.hash!==s){const e={...h,hash:s};await(0,U.qC)(e,d.Ul.USER_KYC,r,l)}}else{const e={...h,hash:s};await(0,U.qC)(e,d.Ul.USER_KYC,r,l)}Z&&(console.log(Z),await(0,i.qS)(d.Rb.CREATORS_KYC_DOCUMENTS,y,"Aadhar"),K(0),await(0,i.FV)(d.Rb.CREATORS_KYC_DOCUMENTS,Z,y,"Aadhar",(e=>K(e)),(e=>{C(e),console.log(e)}))),F&&(console.log(F),await(0,i.qS)(d.Rb.CREATORS_KYC_DOCUMENTS,y,"Gst"),Y(0),await(0,i.FV)(d.Rb.CREATORS_KYC_DOCUMENTS,F,y,"Gst",(e=>Y(e)),(e=>{k(e),console.log(e)}))),await(0,i.Xt)(d.Ul.USER,y,{KycIdList:{[w]:h.status}}),e.target.reset()}catch(t){console.error("Error processing KYC: ",t)}finally{P(!1)}},children:[(0,j.jsx)("h1",{style:{color:b?"white":"black",textTransform:"capitalize"},children:"Verify yourself"}),(0,j.jsx)("div",{className:"row",children:T.map((e=>{const t=e.find((e=>!H.includes(e)&&void 0!==h[e]));return t?(0,j.jsx)("div",{className:"col-md-6 col-lg-4",children:(0,j.jsxs)(c.Z.Group,{controlId:"formBasic".concat(t),children:[(0,j.jsx)(g.Z,{style:{color:b?"white":"black"},children:A.get(t)}),["city","state_province"].includes(t)?(0,j.jsxs)(c.Z.Control,{as:"select",placeholder:"Enter ".concat(A.get(t)),name:t,value:h[t],onChange:z,required:!0,className:"glassmorphic-input",style:{backgroundColor:b?"#181818":"#e5e5e5",color:b?"white":"black",paddingTop:0,paddingBottom:0},children:[(0,j.jsxs)("option",{value:"",children:["Select a ",A.get(t)]}),[..."city"===t?D:O].map(((e,t)=>(0,j.jsx)("option",{value:e,children:e},t)))]}):(0,j.jsx)(c.Z.Control,{type:"age"===t||"phone_number"===t?"number":"text",placeholder:"Enter ".concat(A.get(t)),name:t,value:h[t],onChange:z,required:!0,className:"glassmorphic-input",style:{backgroundColor:b?"#181818":"#e5e5e5",color:b?"white":"black"}}),x[t]&&(0,j.jsx)("span",{style:{color:"red"},children:x[t]})," "]})},t):null}))}),(0,j.jsx)("div",{className:"row",children:(0,j.jsxs)("div",{className:"col-md-6 col-lg-4",children:[(0,j.jsxs)(c.Z.Group,{controlId:"formBasicAadhar",children:[(0,j.jsx)(c.Z.Label,{style:{color:b?"white":"black"},children:"Aadhar"}),(0,j.jsxs)("div",{className:"d-flex align-items-center",children:[(0,j.jsx)(c.Z.Control,{type:"text",placeholder:"Enter Aadhar Number",name:"aadhar",className:"glassmorphic-input",value:h.aadhar,onChange:z,style:{backgroundColor:b?"#181818":"#e5e5e5",color:b?"white":"black",marginRight:"10px"}}),(0,j.jsx)(s.Z,{disable:"Verified"===h.status,variant:"light",onClick:()=>document.getElementById("aadharUpload").click(),style:{padding:"0.5rem",backgroundColor:b?"#333":"#f8f9fa",color:b?"white":"black",cursor:"pointer"},children:"Upload"}),(0,j.jsx)("input",{type:"file",id:"aadharUpload",accept:".pdf",style:{display:"none"},onChange:e=>(e=>{N(e.target.files[0]),$(!0)})(e)})]}),v&&v.length>0&&v[0].fileURL?(0,j.jsx)(s.Z,{variant:"link",style:{color:"#007bff",textDecoration:"none"},onClick:()=>window.open(v[0].fileURL,"_blank"),children:"Download Aadhar Document"}):(0,j.jsx)("p",{style:{color:b?"white":"black"},children:(null===Z||void 0===Z?void 0:Z.name)||"No new Aadhar file uploaded."})]}),x.aadhar&&(0,j.jsx)("span",{style:{color:"red"},children:x.aadhar}),(0,j.jsx)("div",{children:G>=0&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("progress",{value:G,max:"100"}),(0,j.jsxs)("p",{children:[G,"% uploaded"]})]})})]})}),(0,j.jsx)("div",{className:"row",children:(0,j.jsxs)("div",{className:"col-md-6 col-lg-4",children:[(0,j.jsxs)(c.Z.Group,{controlId:"formBasicGst",children:[(0,j.jsx)(c.Z.Label,{style:{color:b?"white":"black"},children:"GST"}),(0,j.jsxs)("div",{className:"d-flex align-items-center",children:[(0,j.jsx)(c.Z.Control,{type:"text",placeholder:"Enter GST Number",name:"gstin",value:h.gstin,onChange:z,className:"glassmorphic-input",style:{backgroundColor:b?"#181818":"#e5e5e5",color:b?"white":"black",marginRight:"10px"}}),(0,j.jsx)(s.Z,{disable:"Verified"===h.status,variant:"light",onClick:()=>document.getElementById("gstUpload").click(),style:{padding:"0.5rem",backgroundColor:b?"#333":"#f8f9fa",color:b?"white":"black",cursor:"pointer"},children:"Upload"}),(0,j.jsx)("input",{type:"file",id:"gstUpload",accept:".pdf",style:{display:"none"},onChange:e=>(e=>{L(e.target.files[0]),$(!0)})(e)})]}),E&&E.length>0&&E[0].fileURL?(0,j.jsx)(s.Z,{variant:"link",style:{color:"#007bff",textDecoration:"none"},onClick:()=>window.open(E[0].fileURL,"_blank"),children:"Download GST Document"}):(0,j.jsxs)("p",{style:{color:b?"white":"black"},children:[" ",(null===F||void 0===F?void 0:F.name)||"No new GST file uploaded."]})]}),x.gstin&&(0,j.jsx)("span",{style:{color:"red"},children:x.gstin}),(0,j.jsx)("div",{children:M>=0&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("progress",{value:M,max:"100"}),(0,j.jsxs)("p",{children:[M,"% uploaded"]})]})})]})}),(0,j.jsxs)("div",{class:"form-check",children:[(0,j.jsx)("input",{type:"checkbox",class:"form-check-input",id:"tnc-switch",checked:h.tncAgreed,onChange:e=>{u((t=>({...t,tncAgreed:e.target.checked})))}}),(0,j.jsx)("label",{class:"form-check-label",for:"exampleCheck1",children:(0,j.jsxs)("span",{style:{color:b?"white":"black"},children:["I agree to the ",(0,j.jsx)("a",{href:"#/npoliciesStudio",style:{color:b?"lightblue":"blue"},children:"Terms and Conditions. Click to read."})]})})]}),(0,j.jsx)("br",{}),h.comments&&(0,j.jsxs)("div",{className:"col-md-12 col-lg-12",children:[(0,j.jsx)("br",{}),(0,j.jsxs)(c.Z.Group,{controlId:"formBasicComments",children:[(0,j.jsx)(c.Z.Label,{children:A.get("comments")}),(0,j.jsx)(c.Z.Control,{as:"textarea",name:"comments",value:h.comments,readOnly:!0,style:{backgroundColor:b?"#181818":"#e5e5e5",color:b?"white":"black"}})]})]}),(0,j.jsx)(s.Z,{variant:"info",type:"submit",disabled:"Verified"===h.status||!h.tncAgreed,children:"Submit"})]}),B&&(0,j.jsx)(R.Z,{}),(0,j.jsx)("br",{}),(0,j.jsx)(j.Fragment,{children:h.hash&&(0,j.jsx)(S,{kycId:w,status:h.status})})]}),(0,j.jsx)("br",{})]})}},68449:(e,t,a)=>{a.d(t,{FV:()=>j,Km:()=>b,Ld:()=>u,Us:()=>h,XG:()=>v,Xt:()=>p,eg:()=>w,gG:()=>d,gY:()=>i,gv:()=>m,ih:()=>x,oM:()=>l,qS:()=>f,to:()=>g,xR:()=>y});var n=a(12481),o=a(10159),c=a(30276),s=a(83708),r=a(644);const l=async e=>{const t=s.A3,a="".concat(t,"crud/getUserMode/").concat(e);try{const e=await fetch(a),t=await e.json();if(t.success){let e=!1;!0===t.data&&(e=!0),r.Z.setItem("CreatorMode",e)}else console.log("Error: ",t.message||"Unknown error")}catch(n){console.log("Error fetching user mode: ",n),r.Z.setItem("CreatorMode",!1)}},i=async(e,t,a)=>{const n=s.A3;try{const o="".concat(n,"crud/").concat(e,"/").concat(t,"/");console.log(o);const c=await fetch(o),s=await c.json();s.success?a(s.data):console.error("Error fetching ".concat(t,":"),s.error)}catch(o){console.error("Error fetching ".concat(t,":"),o)}},d=async e=>(await l(e),await(async()=>{try{const e=r.Z.getItem("CreatorMode");return console.log("getCreatorMode ",e),e||!1}catch(e){return console.log(" error"),!1}})()),h=async(e,t)=>{console.log("Debug ","".concat(e,"/").concat(t));const a="".concat(e,"/").concat(t),n=(0,c.iH)(o.tO,a);try{const e=await(0,c.aF)(n);if(e.items.length>0){const t=e.items[0],a=await(0,c.Jt)(t);return console.log("Debug URL:",a),a}return console.log("Debug No files found in the folder."),null}catch(s){return console.error("Error getting image URL:",s),null}},u=async(e,t)=>{const a=(0,n.JU)(o.db,e,t),c=await(0,n.QT)(a);return c.exists()?c.data():null},m=async(e,t,a)=>{const c=(0,n.JU)(o.db,e,t);return await(0,n.pl)(c,a,{merge:!0}),a},g=async(e,t,a)=>{const c=(0,n.JU)(o.db,e,t);return await(0,n.r7)(c,{isPhoneNumberVerified:!0,phoneNumber:a}),!0},p=async(e,t,a)=>{const c=(0,n.JU)(o.db,e,t);return await(0,n.r7)(c,a),{id:t,...a}},b=async(e,t,a,c)=>{console.log("Hiii ",e,t,a,c);const s=(0,n.IO)((0,n.hJ)(o.db,e),(0,n.ar)(t,a,c));return(await(0,n.Yp)(s)).data().count},x=async(e,t)=>{const a="".concat(e,"/").concat(t),n=(0,c.iH)(o.tO,a),s=await(0,c.aF)(n);await Promise.all(s.items.map((async e=>{await(0,c.oq)(e)})))},f=async(e,t,a)=>{const n="".concat(e,"/").concat(t,"/").concat(a),s=(0,c.iH)(o.tO,n),r=await(0,c.aF)(s);await Promise.all(r.items.map((async e=>{await(0,c.oq)(e)})))},y=async function(e,t,a,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const r=t.length;let l=0;await Promise.all(t.map((async t=>{let i="".concat(e,"/").concat(a,"/").concat(t.filename);s&&(i="".concat(e,"/").concat(a,"/").concat(s,"/").concat(t.filename));const d=(0,c.iH)(o.tO,i);await(0,c.oq)(d),l+=1,n(l/r*100)})))},w=async function(e,t,a,n){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;console.log(e,a);const r=t.length;let l=0;await Promise.all(t.map((async t=>{let i="".concat(e,"/").concat(a);s&&(i="".concat(e,"/").concat(a,"/").concat(s));const d=(0,c.iH)(o.tO,"".concat(i,"/").concat(t.file.name));await(0,c.KV)(d,t.file),l+=1,n(l/r*100)})))},j=async function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4?arguments[4]:void 0,r=arguments.length>5?arguments[5]:void 0,l="".concat(e,"/").concat(a);n&&(l="".concat(e,"/").concat(a,"/").concat(n)),console.log(t,t.name);const i=(0,c.iH)(o.tO,"".concat(l,"/").concat(t.name)),d=(0,c.B0)(i,t);d.on("state_changed",(e=>{const t=e.totalBytes,a=e.bytesTransferred,n=t>0?(a/t*100).toFixed(2):-1;switch(s(n),console.log("Upload is "+n+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(e=>{e.code}),(()=>{(0,c.Jt)(d.snapshot.ref).then((e=>{console.log("File available at",e),r(e)}))}))},v=async e=>{const t="".concat(e),a=(0,c.iH)(o.tO,t);try{const e=await(0,c.aF)(a);return await Promise.all(e.items.map((async e=>{const t=await(0,c.Jt)(e);return{id:e.name,filename:e.name,fileURL:t}})))}catch(n){throw console.error("Error retrieving images:",n),n}}}}]);
//# sourceMappingURL=1893.df08c411.chunk.js.map