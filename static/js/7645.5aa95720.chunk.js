"use strict";(self.webpackChunknritya_webApp=self.webpackChunknritya_webApp||[]).push([[7645],{81018:(e,t,a)=>{a.d(t,{Z:()=>x});var s=a(72791),o=a(6429),r=a.n(o),l=a(30276),n=a(10159),c=a(59434),i=a(60717),d=a(68449),m=a(57621),f=a(13400),u=a(39504),g=a(27247),h=a(75424),b=a(83708),E=a(80184);const p=e=>{let{entityId:t,storageFolder:a,title:o,maxImageCount:p=10,updateMode:x,disable:I}=e;const C=(0,h.D)(),[y,j]=(0,s.useState)([]),[S,R]=(0,s.useState)([]),[N,A]=(0,s.useState)([]),[k,U]=(0,s.useState)([]),v=(0,c.v9)(i.w);console.log("Kyc enitity id ",t,I);const w=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";const a=t<0?0:t,s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(a))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][s]};(0,s.useEffect)((()=>{t&&D(t)}),[t]),(0,s.useEffect)((()=>{if(p&&y.length>p){const e=y.slice(0,p);alert(`Exceeded maxImageCount, keeping first ${p} files.`),j(e)}}),[y,p]);const O=(e,t)=>{const a=e.map((e=>e.id)),s=t.map((e=>e.id));return{imagesToDelete:t.filter((e=>!a.includes(e.id))),newImages:e.filter((e=>!s.includes(e.id)))}},D=async e=>{j([]),A([]),U([]);try{const t=`${a}/${e}`;console.log(t);const s=(0,l.iH)(n.tO,t),o=await(0,l.aF)(s),r=await Promise.all(o.items.map((async e=>{const t=await(0,l.Jt)(e);return{id:e.name,filename:e.name,fileURL:t}})));R(r),j(r)}catch(t){console.error("Error fetching user images:",t)}};return(0,E.jsx)("div",{className:"fileupload-view",style:{display:"flex",width:"100%",justifyContent:"center"},children:(0,E.jsx)("div",{className:"row justify-content-center m-0",style:{flex:"1",justifyContent:"center"},children:(0,E.jsx)("div",{className:"col-md-6",style:{flex:"1",justifyContent:"center"},children:(0,E.jsx)("div",{className:"card mt-5",children:(0,E.jsx)("div",{className:"card-body",style:{backgroundColor:v?"#333333":"white"},children:(0,E.jsxs)("div",{className:"kb-data-box",children:[(0,E.jsx)("div",{className:"kb-modal-data-title",children:(0,E.jsxs)("div",{className:"kb-data-title",style:{justifyContent:"center",flex:"1"},children:[(0,E.jsx)("h4",{children:o}),(0,E.jsxs)("p",{children:["Max no of image(s):",p," ",a===b.Rb.STUDIOIMAGES&&(0,E.jsx)("p",{children:"Add at least 5 images"})]})]})}),(0,E.jsxs)("form",{style:{backgroundColor:v?"#333333":"white"},children:[(0,E.jsx)("div",{className:"kb-file-upload",children:(0,E.jsx)("div",{className:"file-upload-box",children:(0,E.jsx)("input",{type:"file",id:"fileupload",className:"file-upload-input",onChange:e=>{const t=Array.from(e.target.files),a=[];t.forEach((e=>{const s=new FileReader;s.onloadend=()=>{a.push({id:r().generate(),filename:e.name,filetype:e.type,fileimage:s.result,datetime:e.lastModifiedDate.toLocaleString("en-IN"),filesize:w(e.size),file:e}),a.length===t.length&&(j((e=>[...e,...a])),A(a))},s.readAsDataURL(e)}))},multiple:!0})})}),(0,E.jsx)("br",{}),(0,E.jsx)("div",{className:"kb-attach-box mb-3",children:(0,E.jsx)("div",{className:"row",children:t&&y.length>0?y.map((e=>(0,E.jsx)("div",{className:"col-6 col-md-3 mb-3",style:{position:"relative"},children:(0,E.jsx)(m.Z,{sx:{maxWidth:345},children:e.filename.match(/\.(jpg|jpeg|png|gif|svg)$/i)?(0,E.jsxs)("div",{style:{position:"relative"},children:[(0,E.jsx)("img",{src:e.fileimage?e.fileimage:e.fileURL,alt:e.filename,className:"card-img-top",style:{maxHeight:"150px",objectFit:"cover"}}),(0,E.jsx)(f.Z,{"aria-label":"delete",disabled:I,onClick:()=>(e=>{if(window.confirm("Are you sure you want to delete this image?")){const t=y.find((t=>t.id===e));U((e=>[...e,t])),j((t=>t.filter((t=>t.id!==e))))}})(e.id),style:{position:"absolute",top:0,right:0,backgroundColor:"rgba(255, 255, 255, 0.5)"},children:(0,E.jsx)(g.Z,{style:{color:"ff0000"}})})]}):(0,E.jsx)(u.Z,{children:(0,E.jsx)("i",{className:"far fa-file-alt"})})})},e.id))):(0,E.jsx)("div",{className:"col-12 text-center",children:(0,E.jsx)("p",{children:"No images selected"})})})}),(0,E.jsx)("div",{className:"kb-buttons-box",children:(0,E.jsx)("button",{type:"button",className:"btn form-submit",style:{backgroundColor:v?"#892CDC":"black",color:"white"},onClick:async()=>{if(t)try{if(1===p)await(0,d.ih)(a,t),await(0,d.eg)(a,N,t);else{const{imagesToDelete:e,newImages:s}=O(y,S);e.length>0&&await(0,d.xR)(a,e,t),s.length>0&&await(0,d.eg)(a,s,t)}C("Images Uploaded/Deleted","success")}catch(e){console.error("Error uploading/deleting images:",e)}else alert("No studio selected")},disabled:I,children:"Image Upload"})})]}),y.length>0&&(0,E.jsx)("div",{className:"kb-attach-box",hidden:!0,children:(0,E.jsxs)("div",{className:"row",children:[(0,E.jsx)("hr",{}),y.map((e=>(0,E.jsx)("div",{className:"col-6 col-md-3 mb-3",children:(0,E.jsx)("div",{className:"card",children:e.filename.match(/\.(jpg|jpeg|png|gif|svg)$/i)?(0,E.jsx)("img",{src:e.fileimage,alt:e.filename,className:"card-img-top",style:{maxHeight:"150px",objectFit:"cover"}}):(0,E.jsx)("div",{className:"card-body",children:(0,E.jsx)("i",{className:"far fa-file-alt"})})})},e.id)))]})})]})})})})})})};p.defaultProps={maxImageCount:5,updateMode:!1,disable:!1};const x=p},37645:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var s=a(72791),o=a(47022),r=a(13855),l=a(43360),n=a(59434),c=a(60717),i=a(68449),d=a(83708),m=a(67107),f=a(44507),u=a(35527),g=a(20890),h=a(63875),b=a(74512),E=a(15825),p=a(66934),x=a(56856),I=a(23285),C=a(80184);const y=(0,p.ZP)(x.Z)((e=>{let{theme:t}=e;return{[`&.${I.Z.alternativeLabel}`]:{top:10,left:"calc(-50% + 16px)",right:"calc(50% + 16px)"},[`&.${I.Z.active}`]:{[`& .${I.Z.line}`]:{borderColor:"green"}},[`&.${I.Z.completed}`]:{[`& .${I.Z.line}`]:{borderColor:"green"}},[`& .${I.Z.line}`]:{borderColor:"dark"===t.palette.mode?t.palette.grey[800]:"#eaeaf0",borderTopWidth:3,borderRadius:1}}})),j=[d.n$.SUBMITTED,d.n$.UNDER_REVIEW,d.n$.REVIEWED,d.n$.VERIFIED],S={[d.n$.SUBMITTED]:0,[d.n$.UNDER_REVIEW]:1,[d.n$.REVIEWED]:2,[d.n$.VERIFIED]:3,[d.n$.VERIFICATION_FAILED]:3},R=e=>{let{kycId:t,status:a}=e;const o=(0,n.v9)(c.w),[r,l]=(0,s.useState)({});console.log(a);const p=(0,m.Z)({palette:{mode:o?"dark":"light",primary:{main:o?"#90caf9":"#1976d2"}}});return(0,s.useEffect)((()=>{(async()=>{try{const e=await(0,i.Ld)(d.Ul.USER_KYC,t);l(e)}catch(e){console.error(`Error fetching KYC data for KYC ID ${t}:`,e)}})()}),[t]),(0,C.jsx)(f.Z,{theme:p,children:(0,C.jsxs)(u.Z,{sx:{textAlign:"center",marginBottom:"1rem"},elevation:2,children:[(0,C.jsxs)(g.Z,{variant:"h5",component:"p",children:["Application Status: ",a]}),(0,C.jsx)("br",{}),(0,C.jsx)(h.Z,{activeStep:S[a],alternativeLabel:!0,connector:(0,C.jsx)(y,{}),children:j.map(((e,t)=>(0,C.jsx)(b.Z,{children:(0,C.jsx)(E.Z,{error:e===d.n$.VERIFIED&&a===d.n$.VERIFICATION_FAILED,children:e===d.n$.VERIFIED&&a===d.n$.VERIFICATION_FAILED?"Failed Verification":e})},t)))}),(0,C.jsx)("br",{})]})})};var N=a(89704),A=a.n(N);var k=a(81018);const U=new Map([["first_name","First Name"],["middle_last_name","Middle & Last Name"],["phone_number","Phone Number"],["street_address","Street Address"],["city","City"],["state_province","State"],["state","State"],["zip_pin_code","PIN Code/ZIP"],["aadhar","Aadhar Number"],["gstin","GST Number"],["comments","Remark(s)"]]);const v=function(){const[e,t]=(0,s.useState)({first_name:"",middle_last_name:"",phone_number:"",street_address:"",city:"",state_province:"",zip_pin_code:"",country:"India",aadhar:"",gstin:"",comments:"",status:d.n$.SUBMITTED,tncAgreed:!1,hash:""}),[a,m]=(0,s.useState)(null),f=(0,n.v9)(c.w),[u,g]=(0,s.useState)({}),h=JSON.parse(localStorage.getItem("userInfo")).UserId,b=`${h}_Kyc`,E=e=>{const{name:a,value:s}=e.target;t((e=>({...e,[a]:s})))};return(0,s.useEffect)((()=>{(async()=>{const e=await(0,i.Ld)(d.Ul.USER_KYC,b);e?(m(e),t({...e,status:e.status||d.n$.SUBMITTED})):m(null)})()}),[b]),(0,C.jsxs)("div",{style:{color:f?"white":"black"},children:[(0,C.jsxs)(o.Z,{style:{margin:"auto",border:f?"1px solid white":"1px solid black",borderRadius:"5px",padding:"20px"},children:[(0,C.jsxs)(r.Z,{onSubmit:async t=>{t.preventDefault();try{const a=Object.keys(e).filter((e=>!["hash","status","country","comments","UserId"].includes(e)));let s=!0,o=[],r=0;if(a.forEach((t=>{const a=((e,t)=>{let a="";switch(console.log(e,t),e){case"phone_number":/^\d{10}$/.test(t)||(a="Phone number must be exactly 10 digits.");break;case"zip_pin_code":/^\d{6}$/.test(t)||(a="ZIP/Pin code must be exactly 6 digits.");break;case"aadhar":/^\d{12}$/.test(t)||(a="Aadhar number must be exactly 12 digits.");break;case"gstin":/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}[Z]{1}[0-9A-Z]{1}$/.test(t)||(a="GSTIN must be a valid format (e.g., 22AAAAA0000A1Z5).")}return console.log(a),a})(t,e[t]);a&&(s=!1,r+=1,o.push(`${r}: ${a}`),g((e=>({...e,[t]:a}))))})),!s)return void alert(`Please correct the following errors before submitting:\n\n${o.join("\n")}`);const l=await(0,i.Ld)(d.Ul.USER_KYC,b),n=(e=>{const t=Object.keys(e).filter((e=>"hash"!==e&&"status"!==e)).sort().map((t=>`${t}:${e[t]}`)).join("|");return A().SHA256(t).toString()})(e);l?l.hash!==n?(await(0,i.Xt)(d.Ul.USER_KYC,b,{...e,hash:n}),alert("KYC updated successfully")):alert("No changes detected"):(await(0,i.gv)(d.Ul.USER_KYC,b,{...e,UserId:h,hash:n}),alert("KYC added successfully")),await(0,i.Xt)(d.Ul.USER,h,{KycIdList:{[b]:e.status}}),t.target.reset()}catch(a){console.error("Error processing KYC: ",a)}},children:[(0,C.jsx)("h1",{style:{color:f?"white":"black",textTransform:"capitalize"},children:"Verify yourself"}),(0,C.jsx)("div",{className:"row",children:Object.keys(e).map((t=>"status"!==t&&"hash"!==t&&"country"!==t&&"tncAgreed"!==t&&"comments"!==t&&"UserId"!==t&&(0,C.jsx)("div",{className:"col-md-6 col-lg-4",children:(0,C.jsxs)(r.Z.Group,{controlId:`formBasic${t}`,children:[(0,C.jsx)(r.Z.Label,{children:U.get(String(t))}),(0,C.jsx)(r.Z.Control,{type:"age"===t||"phone_number"===t?"number":"text",placeholder:`Enter ${U.get(String(t))}`,name:t,value:e[t],onChange:E,required:!0,style:{backgroundColor:f?"#181818":"#e5e5e5",color:f?"white":"black"}})]})},t)))}),(0,C.jsx)(k.Z,{disable:"Verified"===e.status,entityId:h,title:"Upload Documents",storageFolder:d.Rb.CREATORS_KYC_DOCUMENTS}),(0,C.jsxs)("div",{class:"form-check",children:[(0,C.jsx)("input",{type:"checkbox",class:"form-check-input",id:"tnc-switch",checked:e.tncAgreed,onChange:e=>{t((t=>({...t,tncAgreed:e.target.checked})))}}),(0,C.jsx)("label",{class:"form-check-label",for:"exampleCheck1",children:(0,C.jsxs)("span",{children:["I agree to the ",(0,C.jsx)("a",{href:"#/npolicies/1",style:{color:f?"lightblue":"blue"},children:"Terms and Conditions. Click to read."})]})})]}),(0,C.jsx)("br",{}),e.comments&&(0,C.jsxs)("div",{className:"col-md-12 col-lg-12",children:[(0,C.jsx)("br",{}),(0,C.jsxs)(r.Z.Group,{controlId:"formBasicComments",children:[(0,C.jsx)(r.Z.Label,{children:U.get("comments")}),(0,C.jsx)(r.Z.Control,{as:"textarea",name:"comments",value:e.comments,readOnly:!0,style:{backgroundColor:f?"#181818":"#e5e5e5",color:f?"white":"black"}})]})]}),(0,C.jsx)(l.Z,{variant:"success",type:"submit",disabled:"Verified"===e.status||!e.tncAgreed,children:"Submit"})]}),(0,C.jsx)("br",{}),(0,C.jsx)(C.Fragment,{children:e.hash&&(0,C.jsx)(R,{kycId:b,status:e.status})})]}),(0,C.jsx)("br",{})]})}},83708:(e,t,a)=>{a.d(t,{A3:()=>g,QP:()=>h,RY:()=>d,Rb:()=>u,Ul:()=>f,i0:()=>l,lt:()=>m,n$:()=>r,uM:()=>c,zq:()=>n});var s=a(59135),o=a(80184);const r={SUBMITTED:"Submitted",UNDER_REVIEW:"Under Review",REVIEWED:"Reviewed",VERIFIED:"Verified",VERIFICATION_FAILED:"Verification Failed"},l={DRAFT_STUDIOS:"DraftStudios",DRAFT_WORKSHOPS:"DraftWorkshops",DRAFT_OPEN_CLASSES:"DraftOpenClasses",DRAFT_COURSES:"DraftCourses"},n={ALL:"All",BEGINNERS:"Beginner",INTERMEDIATE:"Intermediate",ADVANCED:"Advanced"},c={PROD:"https://nrityaserver-2b241e0a97e5.herokuapp.com/",LOCAL:"http://127.0.0.1:8000/"},i={GREEN:{backgroundColor:"#28a745",color:"#fff"},BLUE:{backgroundColor:"#007bff",color:"#fff"},YELLOW:{backgroundColor:"#ffc107",color:"#000"},RED:{backgroundColor:"#dc3545",color:"#fff"},PURPLE:{backgroundColor:"#6f42c1",color:"#fff"},ORANGE:{backgroundColor:"#fd7e14",color:"#fff"},TEAL:{backgroundColor:"#20c997",color:"#fff"},PINK:{backgroundColor:"#e83e8c",color:"#fff"},GRAY:{backgroundColor:"#6c757d",color:"#fff"},LIGHTBLUE:{backgroundColor:"#17a2b8",color:"#fff"},DARKBLUE:{backgroundColor:"#343a40",color:"#fff"},CYAN:{backgroundColor:"#00bcd4",color:"#fff"},INDIGO:{backgroundColor:"#6610f2",color:"#fff"},LIME:{backgroundColor:"#cddc39",color:"#000"},AMBER:{backgroundColor:"#ffca28",color:"#000"},BROWN:{backgroundColor:"#795548",color:"#fff"},LIGHTGREEN:{backgroundColor:"#8bc34a",color:"#000"},DEEPPURPLE:{backgroundColor:"#673ab7",color:"#fff"},DEEPORANGE:{backgroundColor:"#ff5722",color:"#fff"},BLACK:{backgroundColor:"#000000",color:"#fff"},WHITE:{backgroundColor:"#ffffff",color:"#000"},SILVER:{backgroundColor:"#c0c0c0",color:"#000"},GOLD:{backgroundColor:"#ffd700",color:"#000"},NAVY:{backgroundColor:"#001f3f",color:"#fff"},OLIVE:{backgroundColor:"#3d9970",color:"#fff"}},d={[n.ALL]:i.GREEN,[n.BEGINNERS]:i.BLUE,[n.INTERMEDIATE]:i.YELLOW,[n.ADVANCED]:i.RED},m=[i.PURPLE,i.ORANGE,i.TEAL,i.LIME],f={USER:"User",USER_KYC:"UserKyc",ADMIN:"Admin",REVIEWS:"Reviews",TRANSACTIONS:"Transactions",STUDIO:"Studio",INSTRUCTORS:"Instructors",FREE_TRIAL_BOOKINGS:"FreeTrialBookings",WORKSHOPS:"Workshops",OPEN_CLASSES:"OpenClasses",COURSES:"Courses",BOOKINGS:"Bookings"},u={STUDIOIMAGES:"StudioImages",STUDIOICON:"StudioIcon",STUDIOANNOUNCEMENTS:"StudioAnnouncements",USERIMAGE:"UserImage",INSTRUCTORIMAGES:"InstructorImages",WORKSHOPICON:"WorkshopIcon",WORKSHOPIMAGES:"WorkshopImages",OPENCLASSICON:"OpenClassIcon",COURSEICON:"CourseIcon",CREATORS_KYC_DOCUMENTS:"CreatorKycDocuments"},g="https://nrityaserver-2b241e0a97e5.herokuapp.com/",h={AC:(0,o.jsx)(s.l51,{}),"Free Wifi":(0,o.jsx)(s._0,{}),"RO Water":(0,o.jsx)(s.EXY,{}),Toilet:(0,o.jsx)(s.Iev,{}),"Power Backup":(0,o.jsx)(s.eKD,{}),"Fire Extinguisher":(0,o.jsx)(s.Ybg,{}),"First Aid Kit":(0,o.jsx)(s.FZx,{}),"CCTV Camera":(0,o.jsx)(s.KoQ,{}),"Card Payment":(0,o.jsx)(s.ypE,{}),"Parking Space":(0,o.jsx)(s.mxg,{})}},68449:(e,t,a)=>{a.d(t,{Gz:()=>p,Km:()=>g,Ld:()=>d,Us:()=>i,Xt:()=>u,eg:()=>E,gv:()=>m,ih:()=>h,oM:()=>c,to:()=>f,xR:()=>b});var s=a(12481),o=a(10159),r=a(30276),l=a(83708),n=a(644);const c=async e=>{console.log("setCreatorMode ",e);try{const t=(0,s.JU)(o.db,l.Ul.USER,e),a=await(0,s.QT)(t);if(a.exists())if(null!=a.data()){const e=a.data().CreatorMode;console.log("setCreatorMode: Is User a creator?",e),n.Z.setItem("CreatorMode",e)}else console.log("userSnap.data() null");else console.log("User not found")}catch(t){console.log(" error")}},i=async(e,t)=>{console.log("Debug ",`${e}/${t}`);const a=`${e}/${t}`,s=(0,r.iH)(o.tO,a);try{const e=await(0,r.aF)(s);if(e.items.length>0){const t=e.items[0],a=await(0,r.Jt)(t);return console.log("Debug URL:",a),a}return console.log("Debug No files found in the folder."),null}catch(l){return console.error("Error getting image URL:",l),null}},d=async(e,t)=>{const a=(0,s.JU)(o.db,e,t),r=await(0,s.QT)(a);return r.exists()?r.data():null},m=async(e,t,a)=>{const r=(0,s.JU)(o.db,e,t);return await(0,s.pl)(r,a,{merge:!0}),a},f=async(e,t,a)=>{const r=(0,s.JU)(o.db,e,t);return await(0,s.r7)(r,{isPhoneNumberVerified:!0,phoneNumber:a}),!0},u=async(e,t,a)=>{const r=(0,s.JU)(o.db,e,t);return await(0,s.r7)(r,a),{id:t,...a}},g=async(e,t,a,r)=>{console.log("Hiii ",e,t,a,r);const l=(0,s.IO)((0,s.hJ)(o.db,e),(0,s.ar)(t,a,r));return(await(0,s.Yp)(l)).data().count},h=async(e,t)=>{const a=`${e}/${t}`,s=(0,r.iH)(o.tO,a),l=await(0,r.aF)(s);await Promise.all(l.items.map((async e=>{await(0,r.oq)(e)})))},b=async(e,t,a)=>{await Promise.all(t.map((async t=>{const s=(0,r.iH)(o.tO,`${e}/${a}/${t.filename}`);await(0,r.oq)(s)})))},E=async(e,t,a)=>{console.log(e,a),await Promise.all(t.map((async t=>{const s=`${e}/${a}`,l=(0,r.iH)(o.tO,`${s}/${t.file.name}`);await(0,r.KV)(l,t.file)})))},p=async e=>{const t=`${e}`,a=(0,r.iH)(o.tO,t);try{const e=await(0,r.aF)(a);return await Promise.all(e.items.map((async e=>{const t=await(0,r.Jt)(e);return{id:e.name,filename:e.name,fileURL:t}})))}catch(s){throw console.error("Error retrieving images:",s),s}}}}]);
//# sourceMappingURL=7645.5aa95720.chunk.js.map