"use strict";(self.webpackChunknritya_webApp=self.webpackChunknritya_webApp||[]).push([[1893],{41893:(e,t,a)=>{a.r(t),a.d(t,{default:()=>O});var s=a(72791),n=a(47022),o=a(95313),l=a(43360),r=a(59434),c=a(60717),i=a(68449),d=a(83708),h=a(61979),u=a(44507),m=a(35527),p=a(20890),g=a(63875),x=a(74512),b=a(15825),f=a(66934),j=a(56856),y=a(23285),C=a(80184);const v=(0,f.ZP)(j.Z)((e=>{let{theme:t}=e;return{["&.".concat(y.Z.alternativeLabel)]:{top:10,left:"calc(-50% + 16px)",right:"calc(50% + 16px)"},["&.".concat(y.Z.active)]:{["& .".concat(y.Z.line)]:{borderColor:"green"}},["&.".concat(y.Z.completed)]:{["& .".concat(y.Z.line)]:{borderColor:"green"}},["& .".concat(y.Z.line)]:{borderColor:"dark"===t.palette.mode?t.palette.grey[800]:"#eaeaf0",borderTopWidth:3,borderRadius:1}}})),E=[d.n$.SUBMITTED,d.n$.UNDER_REVIEW,d.n$.REVIEWED,d.n$.VERIFIED],S={[d.n$.SUBMITTED]:0,[d.n$.UNDER_REVIEW]:1,[d.n$.REVIEWED]:2,[d.n$.VERIFIED]:3,[d.n$.VERIFICATION_FAILED]:3},_=e=>{let{kycId:t,status:a}=e;const n=(0,r.v9)(c.w),[o,l]=(0,s.useState)({});console.log(a);const f=(0,h.Z)({palette:{mode:n?"dark":"light",primary:{main:n?"#90caf9":"#1976d2"}}});return(0,s.useEffect)((()=>{(async()=>{try{const e=await(0,i.Ld)(d.Ul.USER_KYC,t);l(e)}catch(e){console.error("Error fetching KYC data for KYC ID ".concat(t,":"),e)}})()}),[t]),(0,C.jsx)(u.Z,{theme:f,children:(0,C.jsxs)(m.Z,{sx:{textAlign:"center",marginBottom:"1rem"},elevation:2,children:[(0,C.jsxs)(p.Z,{variant:"h5",component:"p",children:["Application Status: ",a]}),(0,C.jsx)("br",{}),(0,C.jsx)(g.Z,{activeStep:S[a],alternativeLabel:!0,connector:(0,C.jsx)(v,{}),children:E.map(((e,t)=>(0,C.jsx)(x.Z,{children:(0,C.jsx)(b.Z,{error:e===d.n$.VERIFIED&&a===d.n$.VERIFICATION_FAILED,children:e===d.n$.VERIFIED&&a===d.n$.VERIFICATION_FAILED?"Failed Verification":e})},t)))}),(0,C.jsx)("br",{})]})})};var k=a(89704),I=a.n(k);const w=(e,t)=>{let a="";switch(console.log(e,t),e){case"phone_number":/^\d{10}$/.test(t)||(a="Phone number must be exactly 10 digits.");break;case"zip_pin_code":/^\d{6}$/.test(t)||(a="ZIP/Pin code must be exactly 6 digits.");break;case"aadhar":t&&!/^\d{12}$/.test(t)&&(a="Aadhar number must be exactly 12 digits.");break;case"gstin":t&&!/^[0-9]{2}[A-Za-z]{5}[0-9]{4}[A-Za-z]{1}[1-9A-Za-z]{1}[Zz]{1}[0-9A-Za-z]{1}$/.test(t)&&(a="GSTIN must be a valid format (e.g., 22ABCDE0000A1Z5).")}return console.log(a),a};var Z=a(18406),R=a(57482),N=a(82873),A=a(65202);const U=new Map([["first_name","First Name"],["middle_last_name","Middle & Last Name"],["phone_number","Phone Number"],["street_address","Street Address"],["city","City"],["state_province","State"],["state","State"],["zip_pin_code","PIN Code/ZIP"],["aadhar","Aadhar Number"],["gstin","GST Number"],["comments","Remark(s)"]]),T=[["first_name"],["middle_last_name"],["phone_number"],["street_address"],["city"],["state_province","state"],["zip_pin_code"]],D=N.c,$=A.$;const O=function(){var e,t,a;const[h,u]=(0,s.useState)({first_name:"",middle_last_name:"",phone_number:"",street_address:"",city:"",state_province:"",zip_pin_code:"",country:"India",aadhar:"",gstin:"",comments:"",status:d.n$.SUBMITTED,tncAgreed:!1,hash:""}),[m,g]=(0,s.useState)(null),x=(0,r.v9)(c.w),[b,f]=(0,s.useState)({}),j=null===(e=JSON.parse(localStorage.getItem("userInfo")))||void 0===e?void 0:e.UserId,y="".concat(j,"_Kyc"),[v,E]=(0,s.useState)(null),[S,k]=(0,s.useState)(null),[N,A]=(0,s.useState)([]),[O,V]=(0,s.useState)([]),[F,G]=(0,s.useState)(!1),[L,K]=(0,s.useState)(-1),[Y,B]=(0,s.useState)(-1),[M,z]=(0,s.useState)(!1),P=null===(t=JSON.parse(localStorage.getItem("userInfo")))||void 0===t?void 0:t.email,q=null===(a=JSON.parse(localStorage.getItem("userInfo")))||void 0===a?void 0:a.displayName,W=e=>{const{name:t,value:a}=e.target,s=w(t,a);f((e=>({...e,[t]:s}))),u((e=>({...e,[t]:a})))};(0,s.useEffect)((()=>{(async()=>{const e=await(0,i.Ld)(d.Ul.USER_KYC,y);e?(g(e),u({...e,status:e.status||d.n$.SUBMITTED})):g(null)})(),(async()=>{const e="".concat(d.Rb.CREATORS_KYC_DOCUMENTS,"/").concat(j);try{const[t,a]=await Promise.all([(0,i.XG)("".concat(e,"/Aadhar/")),(0,i.XG)("".concat(e,"/Gst/"))]);t&&t.length>0?E(t):(E(null),console.warn("No Aadhar documents found.")),a&&a.length>0?k(a):(k(null),console.warn("No GST documents found."))}catch(t){console.error("Error fetching KYC documents:",t)}})()}),[y]);const J=["status","hash","country","tncAgreed","comments","UserId","gstin","aadhar"];return(0,C.jsxs)("div",{style:{color:x?"white":"black"},children:[(0,C.jsxs)(n.Z,{className:"glassmorphic-container",style:{margin:"auto",border:x?"1px solid white":"1px solid black",borderRadius:"5px",padding:"20px"},children:[(0,C.jsxs)(o.Z,{onSubmit:async e=>{e.preventDefault(),z(!0);try{const t=Object.keys(h).filter((e=>!["hash","status","country","comments","UserId"].includes(e)));let a=!0,s=[],n=0;if(t.forEach((e=>{const t=w(e,h[e]);t&&(a=!1,n+=1,s.push("".concat(n,": ").concat(t)),f((a=>({...a,[e]:t}))))})),!a)return void alert("Please correct the following errors before submitting:\n\n".concat(s.join("\n")));const o=await(0,i.Ld)(d.Ul.USER_KYC,y),l=(e=>{const t=Object.keys(e).filter((e=>"hash"!==e&&"status"!==e)).sort().map((t=>"".concat(t,":").concat(e[t]))).join("|");return I().SHA256(t).toString()})(h);console.log(l,null===o||void 0===o?void 0:o.hash);const r=P,c={user_name:q,user_id:j};if(o){if(o.hash!==l){const e={...h,hash:l};await(0,Z.qC)(e,d.Ul.USER_KYC,r,c)}}else{const e={...h,hash:l};await(0,Z.qC)(e,d.Ul.USER_KYC,r,c)}N&&(console.log(N),await(0,i.qS)(d.Rb.CREATORS_KYC_DOCUMENTS,j,"Aadhar"),K(0),await(0,i.FV)(d.Rb.CREATORS_KYC_DOCUMENTS,N,j,"Aadhar",(e=>K(e)),(e=>{E(e),console.log(e)}))),O&&(console.log(O),await(0,i.qS)(d.Rb.CREATORS_KYC_DOCUMENTS,j,"Gst"),B(0),await(0,i.FV)(d.Rb.CREATORS_KYC_DOCUMENTS,O,j,"Gst",(e=>B(e)),(e=>{k(e),console.log(e)}))),await(0,i.Xt)(d.Ul.USER,j,{KycIdList:{[y]:h.status}}),e.target.reset()}catch(t){console.error("Error processing KYC: ",t)}finally{z(!1)}},children:[(0,C.jsx)("h1",{style:{color:x?"white":"black",textTransform:"capitalize"},children:"Verify yourself"}),(0,C.jsx)("div",{className:"row",children:T.map((e=>{const t=e.find((e=>!J.includes(e)&&void 0!==h[e]));return t?(0,C.jsx)("div",{className:"col-md-6 col-lg-4",children:(0,C.jsxs)(o.Z.Group,{controlId:"formBasic".concat(t),children:[(0,C.jsx)(p.Z,{style:{color:x?"white":"black"},children:U.get(t)}),["city","state_province"].includes(t)?(0,C.jsxs)(o.Z.Control,{as:"select",placeholder:"Enter ".concat(U.get(t)),name:t,value:h[t],onChange:W,required:!0,className:"glassmorphic-input",style:{backgroundColor:x?"#181818":"#e5e5e5",color:x?"white":"black",paddingTop:0,paddingBottom:0},children:[(0,C.jsxs)("option",{value:"",children:["Select a ",U.get(t)]}),[..."city"===t?D:$].map(((e,t)=>(0,C.jsx)("option",{value:e,children:e},t)))]}):(0,C.jsx)(o.Z.Control,{type:"age"===t||"phone_number"===t?"number":"text",placeholder:"Enter ".concat(U.get(t)),name:t,value:h[t],onChange:W,required:!0,className:"glassmorphic-input",style:{backgroundColor:x?"#181818":"#e5e5e5",color:x?"white":"black"}}),b[t]&&(0,C.jsx)("span",{style:{color:"red"},children:b[t]})," "]})},t):null}))}),(0,C.jsx)("div",{className:"row",children:(0,C.jsxs)("div",{className:"col-md-6 col-lg-4",children:[(0,C.jsxs)(o.Z.Group,{controlId:"formBasicAadhar",children:[(0,C.jsx)(o.Z.Label,{style:{color:x?"white":"black"},children:"Aadhar"}),(0,C.jsxs)("div",{className:"d-flex align-items-center",children:[(0,C.jsx)(o.Z.Control,{type:"text",placeholder:"Enter Aadhar Number",name:"aadhar",className:"glassmorphic-input",value:h.aadhar,onChange:W,style:{backgroundColor:x?"#181818":"#e5e5e5",color:x?"white":"black",marginRight:"10px"}}),(0,C.jsx)(l.Z,{disable:"Verified"===h.status,variant:"light",onClick:()=>document.getElementById("aadharUpload").click(),style:{padding:"0.5rem",backgroundColor:x?"#333":"#f8f9fa",color:x?"white":"black",cursor:"pointer"},children:"Upload"}),(0,C.jsx)("input",{type:"file",id:"aadharUpload",accept:".pdf",style:{display:"none"},onChange:e=>(e=>{A(e.target.files[0]),G(!0)})(e)})]}),v&&v.length>0&&v[0].fileURL?(0,C.jsx)(l.Z,{variant:"link",style:{color:"#007bff",textDecoration:"none"},onClick:()=>window.open(v[0].fileURL,"_blank"),children:"Download Aadhar Document"}):(0,C.jsx)("p",{style:{color:x?"white":"black"},children:(null===N||void 0===N?void 0:N.name)||"No new Aadhar file uploaded."})]}),b.aadhar&&(0,C.jsx)("span",{style:{color:"red"},children:b.aadhar}),(0,C.jsx)("div",{children:L>=0&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("progress",{value:L,max:"100"}),(0,C.jsxs)("p",{children:[L,"% uploaded"]})]})})]})}),(0,C.jsx)("div",{className:"row",children:(0,C.jsxs)("div",{className:"col-md-6 col-lg-4",children:[(0,C.jsxs)(o.Z.Group,{controlId:"formBasicGst",children:[(0,C.jsx)(o.Z.Label,{style:{color:x?"white":"black"},children:"GST"}),(0,C.jsxs)("div",{className:"d-flex align-items-center",children:[(0,C.jsx)(o.Z.Control,{type:"text",placeholder:"Enter GST Number",name:"gstin",value:h.gstin,onChange:W,className:"glassmorphic-input",style:{backgroundColor:x?"#181818":"#e5e5e5",color:x?"white":"black",marginRight:"10px"}}),(0,C.jsx)(l.Z,{disable:"Verified"===h.status,variant:"light",onClick:()=>document.getElementById("gstUpload").click(),style:{padding:"0.5rem",backgroundColor:x?"#333":"#f8f9fa",color:x?"white":"black",cursor:"pointer"},children:"Upload"}),(0,C.jsx)("input",{type:"file",id:"gstUpload",accept:".pdf",style:{display:"none"},onChange:e=>(e=>{V(e.target.files[0]),G(!0)})(e)})]}),S&&S.length>0&&S[0].fileURL?(0,C.jsx)(l.Z,{variant:"link",style:{color:"#007bff",textDecoration:"none"},onClick:()=>window.open(S[0].fileURL,"_blank"),children:"Download GST Document"}):(0,C.jsxs)("p",{style:{color:x?"white":"black"},children:[" ",(null===O||void 0===O?void 0:O.name)||"No new GST file uploaded."]})]}),b.gstin&&(0,C.jsx)("span",{style:{color:"red"},children:b.gstin}),(0,C.jsx)("div",{children:Y>=0&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("progress",{value:Y,max:"100"}),(0,C.jsxs)("p",{children:[Y,"% uploaded"]})]})})]})}),(0,C.jsxs)("div",{class:"form-check",children:[(0,C.jsx)("input",{type:"checkbox",class:"form-check-input",id:"tnc-switch",checked:h.tncAgreed,onChange:e=>{u((t=>({...t,tncAgreed:e.target.checked})))}}),(0,C.jsx)("label",{class:"form-check-label",for:"exampleCheck1",children:(0,C.jsxs)("span",{style:{color:x?"white":"black"},children:["I agree to the ",(0,C.jsx)("a",{href:"#/npoliciesStudio",style:{color:x?"lightblue":"blue"},children:"Terms and Conditions. Click to read."})]})})]}),(0,C.jsx)("br",{}),h.comments&&(0,C.jsxs)("div",{className:"col-md-12 col-lg-12",children:[(0,C.jsx)("br",{}),(0,C.jsxs)(o.Z.Group,{controlId:"formBasicComments",children:[(0,C.jsx)(o.Z.Label,{children:U.get("comments")}),(0,C.jsx)(o.Z.Control,{as:"textarea",name:"comments",value:h.comments,readOnly:!0,style:{backgroundColor:x?"#181818":"#e5e5e5",color:x?"white":"black"}})]})]}),(0,C.jsx)(l.Z,{variant:"info",type:"submit",disabled:"Verified"===h.status||!h.tncAgreed,children:"Submit"})]}),M&&(0,C.jsx)(R.Z,{}),(0,C.jsx)("br",{}),(0,C.jsx)(C.Fragment,{children:h.hash&&(0,C.jsx)(_,{kycId:y,status:h.status})})]}),(0,C.jsx)("br",{})]})}}}]);
//# sourceMappingURL=1893.8956a994.chunk.js.map