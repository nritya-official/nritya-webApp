"use strict";(self.webpackChunknritya_webApp=self.webpackChunknritya_webApp||[]).push([[645],{81018:(e,t,s)=>{s.d(t,{Z:()=>j});var a=s(72791),l=s(6429),i=s.n(l),r=s(30276),n=s(10159),c=s(59434),o=s(60717),d=s(68449),m=s(57621),h=s(13400),u=s(39504),g=s(27247),x=s(75424),f=s(83708),p=s(80184);const b=e=>{let{entityId:t,storageFolder:s,title:l,maxImageCount:b=10,updateMode:j,disable:y}=e;const I=(0,x.D)(),[v,E]=(0,a.useState)([]),[C,N]=(0,a.useState)([]),[k,w]=(0,a.useState)([]),[Z,$]=(0,a.useState)([]),S=(0,c.v9)(o.w);console.log("Kyc enitity id ",t,y);const A=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";const s=t<0?0:t,a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(s))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]};(0,a.useEffect)((()=>{t&&R(t)}),[t]),(0,a.useEffect)((()=>{if(b&&v.length>b){const e=v.slice(0,b);alert(`Exceeded maxImageCount, keeping first ${b} files.`),E(e)}}),[v,b]);const _=(e,t)=>{const s=e.map((e=>e.id)),a=t.map((e=>e.id));return{imagesToDelete:t.filter((e=>!s.includes(e.id))),newImages:e.filter((e=>!a.includes(e.id)))}},R=async e=>{E([]),w([]),$([]);try{const t=`${s}/${e}`;console.log(t);const a=(0,r.iH)(n.tO,t),l=await(0,r.aF)(a),i=await Promise.all(l.items.map((async e=>{const t=await(0,r.Jt)(e);return{id:e.name,filename:e.name,fileURL:t}})));N(i),E(i)}catch(t){console.error("Error fetching user images:",t)}};return(0,p.jsx)("div",{className:"fileupload-view",style:{display:"flex",width:"100%",justifyContent:"center"},children:(0,p.jsx)("div",{className:"row justify-content-center m-0",style:{flex:"1",justifyContent:"center"},children:(0,p.jsx)("div",{className:"col-md-6",style:{flex:"1",justifyContent:"center"},children:(0,p.jsx)("div",{className:"card mt-5",children:(0,p.jsx)("div",{className:"card-body",style:{backgroundColor:S?"#333333":"white"},children:(0,p.jsxs)("div",{className:"kb-data-box",children:[(0,p.jsx)("div",{className:"kb-modal-data-title",children:(0,p.jsxs)("div",{className:"kb-data-title",style:{justifyContent:"center",flex:"1"},children:[(0,p.jsx)("h4",{children:l}),(0,p.jsxs)("p",{children:["Max no of image(s):",b," ",s===f.Rb.STUDIOIMAGES&&(0,p.jsx)("p",{children:"Add at least 5 images"})]})]})}),(0,p.jsxs)("form",{style:{backgroundColor:S?"#333333":"white"},children:[(0,p.jsx)("div",{className:"kb-file-upload",children:(0,p.jsx)("div",{className:"file-upload-box",children:(0,p.jsx)("input",{type:"file",id:"fileupload",className:"file-upload-input",onChange:e=>{const t=Array.from(e.target.files),s=[];t.forEach((e=>{const a=new FileReader;a.onloadend=()=>{s.push({id:i().generate(),filename:e.name,filetype:e.type,fileimage:a.result,datetime:e.lastModifiedDate.toLocaleString("en-IN"),filesize:A(e.size),file:e}),s.length===t.length&&(E((e=>[...e,...s])),w(s))},a.readAsDataURL(e)}))},multiple:!0})})}),(0,p.jsx)("br",{}),(0,p.jsx)("div",{className:"kb-attach-box mb-3",children:(0,p.jsx)("div",{className:"row",children:t&&v.length>0?v.map((e=>(0,p.jsx)("div",{className:"col-6 col-md-3 mb-3",style:{position:"relative"},children:(0,p.jsx)(m.Z,{sx:{maxWidth:345},children:e.filename.match(/\.(jpg|jpeg|png|gif|svg)$/i)?(0,p.jsxs)("div",{style:{position:"relative"},children:[(0,p.jsx)("img",{src:e.fileimage?e.fileimage:e.fileURL,alt:e.filename,className:"card-img-top",style:{maxHeight:"150px",objectFit:"cover"}}),(0,p.jsx)(h.Z,{"aria-label":"delete",disabled:y,onClick:()=>(e=>{if(window.confirm("Are you sure you want to delete this image?")){const t=v.find((t=>t.id===e));$((e=>[...e,t])),E((t=>t.filter((t=>t.id!==e))))}})(e.id),style:{position:"absolute",top:0,right:0,backgroundColor:"rgba(255, 255, 255, 0.5)"},children:(0,p.jsx)(g.Z,{style:{color:"ff0000"}})})]}):(0,p.jsx)(u.Z,{children:(0,p.jsx)("i",{className:"far fa-file-alt"})})})},e.id))):(0,p.jsx)("div",{className:"col-12 text-center",children:(0,p.jsx)("p",{children:"No images selected"})})})}),(0,p.jsx)("div",{className:"kb-buttons-box",children:(0,p.jsx)("button",{type:"button",className:"btn form-submit",style:{backgroundColor:S?"#892CDC":"black",color:"white"},onClick:async()=>{if(t)try{if(1===b)await(0,d.ih)(s,t),await(0,d.eg)(s,k,t);else{const{imagesToDelete:e,newImages:a}=_(v,C);e.length>0&&await(0,d.xR)(s,e,t),a.length>0&&await(0,d.eg)(s,a,t)}I("Images Uploaded/Deleted","success")}catch(e){console.error("Error uploading/deleting images:",e)}else alert("No studio selected")},disabled:y,children:"Image Upload"})})]}),v.length>0&&(0,p.jsx)("div",{className:"kb-attach-box",hidden:!0,children:(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("hr",{}),v.map((e=>(0,p.jsx)("div",{className:"col-6 col-md-3 mb-3",children:(0,p.jsx)("div",{className:"card",children:e.filename.match(/\.(jpg|jpeg|png|gif|svg)$/i)?(0,p.jsx)("img",{src:e.fileimage,alt:e.filename,className:"card-img-top",style:{maxHeight:"150px",objectFit:"cover"}}):(0,p.jsx)("div",{className:"card-body",children:(0,p.jsx)("i",{className:"far fa-file-alt"})})})},e.id)))]})})]})})})})})})};b.defaultProps={maxImageCount:5,updateMode:!1,disable:!1};const j=b},37645:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var a=s(72791),l=s(47022),i=s(13855),r=s(43360),n=s(59434),c=s(60717),o=s(68449),d=s(83708),m=s(67107),h=s(44507),u=s(35527),g=s(20890),x=s(63875),f=s(74512),p=s(15825),b=s(66934),j=s(56856),y=s(23285),I=s(80184);const v=(0,b.ZP)(j.Z)((e=>{let{theme:t}=e;return{[`&.${y.Z.alternativeLabel}`]:{top:10,left:"calc(-50% + 16px)",right:"calc(50% + 16px)"},[`&.${y.Z.active}`]:{[`& .${y.Z.line}`]:{borderColor:"green"}},[`&.${y.Z.completed}`]:{[`& .${y.Z.line}`]:{borderColor:"green"}},[`& .${y.Z.line}`]:{borderColor:"dark"===t.palette.mode?t.palette.grey[800]:"#eaeaf0",borderTopWidth:3,borderRadius:1}}})),E=[d.n$.SUBMITTED,d.n$.UNDER_REVIEW,d.n$.REVIEWED,d.n$.VERIFIED],C={[d.n$.SUBMITTED]:0,[d.n$.UNDER_REVIEW]:1,[d.n$.REVIEWED]:2,[d.n$.VERIFIED]:3,[d.n$.VERIFICATION_FAILED]:3},N=e=>{let{kycId:t,status:s}=e;const l=(0,n.v9)(c.w),[i,r]=(0,a.useState)({});console.log(s);const b=(0,m.Z)({palette:{mode:l?"dark":"light",primary:{main:l?"#90caf9":"#1976d2"}}});return(0,a.useEffect)((()=>{(async()=>{try{const e=await(0,o.Ld)(d.Ul.USER_KYC,t);r(e)}catch(e){console.error(`Error fetching KYC data for KYC ID ${t}:`,e)}})()}),[t]),(0,I.jsx)(h.Z,{theme:b,children:(0,I.jsxs)(u.Z,{sx:{textAlign:"center",marginBottom:"1rem"},elevation:2,children:[(0,I.jsxs)(g.Z,{variant:"h5",component:"p",children:["Application Status: ",s]}),(0,I.jsx)("br",{}),(0,I.jsx)(x.Z,{activeStep:C[s],alternativeLabel:!0,connector:(0,I.jsx)(v,{}),children:E.map(((e,t)=>(0,I.jsx)(f.Z,{children:(0,I.jsx)(p.Z,{error:e===d.n$.VERIFIED&&s===d.n$.VERIFICATION_FAILED,children:e===d.n$.VERIFIED&&s===d.n$.VERIFICATION_FAILED?"Failed Verification":e})},t)))}),(0,I.jsx)("br",{})]})})};var k=s(89704),w=s.n(k);var Z=s(81018);const $=new Map([["first_name","First Name"],["middle_last_name","Middle & Last Name"],["phone_number","Phone Number"],["street_address","Street Address"],["city","City"],["state_province","State"],["state","State"],["zip_pin_code","PIN Code/ZIP"],["aadhar","Aadhar Number"],["gstin","GST Number"],["comments","Remark(s)"]]);const S=function(){const[e,t]=(0,a.useState)({first_name:"",middle_last_name:"",phone_number:"",street_address:"",city:"",state_province:"",zip_pin_code:"",country:"India",aadhar:"",gstin:"",comments:"",status:d.n$.SUBMITTED,tncAgreed:!1,hash:""}),[s,m]=(0,a.useState)(null),h=(0,n.v9)(c.w),[u,g]=(0,a.useState)({}),x=JSON.parse(localStorage.getItem("userInfo")).UserId,f=`${x}_Kyc`,p=e=>{const{name:s,value:a}=e.target;t((e=>({...e,[s]:a})))};return(0,a.useEffect)((()=>{(async()=>{const e=await(0,o.Ld)(d.Ul.USER_KYC,f);e?(m(e),t({...e,status:e.status||d.n$.SUBMITTED})):m(null)})()}),[f]),(0,I.jsxs)("div",{style:{color:h?"white":"black"},children:[(0,I.jsxs)(l.Z,{style:{margin:"auto",border:h?"1px solid white":"1px solid black",borderRadius:"5px",padding:"20px"},children:[(0,I.jsxs)(i.Z,{onSubmit:async t=>{t.preventDefault();try{const s=Object.keys(e).filter((e=>!["hash","status","country","comments","UserId"].includes(e)));let a=!0,l=[],i=0;if(s.forEach((t=>{const s=((e,t)=>{let s="";switch(console.log(e,t),e){case"phone_number":/^\d{10}$/.test(t)||(s="Phone number must be exactly 10 digits.");break;case"zip_pin_code":/^\d{6}$/.test(t)||(s="ZIP/Pin code must be exactly 6 digits.");break;case"aadhar":/^\d{12}$/.test(t)||(s="Aadhar number must be exactly 12 digits.");break;case"gstin":/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}[Z]{1}[0-9A-Z]{1}$/.test(t)||(s="GSTIN must be a valid format (e.g., 22AAAAA0000A1Z5).")}return console.log(s),s})(t,e[t]);s&&(a=!1,i+=1,l.push(`${i}: ${s}`),g((e=>({...e,[t]:s}))))})),!a)return void alert(`Please correct the following errors before submitting:\n\n${l.join("\n")}`);const r=await(0,o.Ld)(d.Ul.USER_KYC,f),n=(e=>{const t=Object.keys(e).filter((e=>"hash"!==e&&"status"!==e)).sort().map((t=>`${t}:${e[t]}`)).join("|");return w().SHA256(t).toString()})(e);r?r.hash!==n?(await(0,o.Xt)(d.Ul.USER_KYC,f,{...e,hash:n}),alert("KYC updated successfully")):alert("No changes detected"):(await(0,o.gv)(d.Ul.USER_KYC,f,{...e,UserId:x,hash:n}),alert("KYC added successfully")),await(0,o.Xt)(d.Ul.USER,x,{KycIdList:{[f]:e.status}}),t.target.reset()}catch(s){console.error("Error processing KYC: ",s)}},children:[(0,I.jsx)("h1",{style:{color:h?"white":"black",textTransform:"capitalize"},children:"Verify yourself"}),(0,I.jsx)("div",{className:"row",children:Object.keys(e).map((t=>"status"!==t&&"hash"!==t&&"country"!==t&&"tncAgreed"!==t&&"comments"!==t&&"UserId"!==t&&(0,I.jsx)("div",{className:"col-md-6 col-lg-4",children:(0,I.jsxs)(i.Z.Group,{controlId:`formBasic${t}`,children:[(0,I.jsx)(i.Z.Label,{children:$.get(String(t))}),(0,I.jsx)(i.Z.Control,{type:"age"===t||"phone_number"===t?"number":"text",placeholder:`Enter ${$.get(String(t))}`,name:t,value:e[t],onChange:p,required:!0,style:{backgroundColor:h?"#181818":"#e5e5e5",color:h?"white":"black"}})]})},t)))}),(0,I.jsx)(Z.Z,{disable:"Verified"===e.status,entityId:x,title:"Upload Documents",storageFolder:d.Rb.CREATORS_KYC_DOCUMENTS}),(0,I.jsxs)("div",{class:"form-check",children:[(0,I.jsx)("input",{type:"checkbox",class:"form-check-input",id:"tnc-switch",checked:e.tncAgreed,onChange:e=>{t((t=>({...t,tncAgreed:e.target.checked})))}}),(0,I.jsx)("label",{class:"form-check-label",for:"exampleCheck1",children:(0,I.jsxs)("span",{children:["I agree to the ",(0,I.jsx)("a",{href:"#/npolicies/1",style:{color:h?"lightblue":"blue"},children:"Terms and Conditions. Click to read."})]})})]}),(0,I.jsx)("br",{}),e.comments&&(0,I.jsxs)("div",{className:"col-md-12 col-lg-12",children:[(0,I.jsx)("br",{}),(0,I.jsxs)(i.Z.Group,{controlId:"formBasicComments",children:[(0,I.jsx)(i.Z.Label,{children:$.get("comments")}),(0,I.jsx)(i.Z.Control,{as:"textarea",name:"comments",value:e.comments,readOnly:!0,style:{backgroundColor:h?"#181818":"#e5e5e5",color:h?"white":"black"}})]})]}),(0,I.jsx)(r.Z,{variant:"success",type:"submit",disabled:"Verified"===e.status||!e.tncAgreed,children:"Submit"})]}),(0,I.jsx)("br",{}),(0,I.jsx)(I.Fragment,{children:e.hash&&(0,I.jsx)(N,{kycId:f,status:e.status})})]}),(0,I.jsx)("br",{})]})}}}]);
//# sourceMappingURL=645.09921f8e.chunk.js.map